<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#000000">
  <meta name="description" content="Ranjan Dasgupta â€” AdTech & AI Advertising. Building platforms at scale.">
  <title>Ranjan Dasgupta | ranjan.adsgupta.com</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800&family=Exo+2:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg: #000000;
      --bg-elevated: #0a0a0a;
      --text: #ffffff;
      --text-muted: rgba(255, 255, 255, 0.6);
      --accent: #3b82f6;
      --neon: #00f5d4;
      --neon-pink: #f72585;
      --neon-violet: #7b2cbf;
      --border: rgba(255, 255, 255, 0.08);
      --font-sans: 'Space Grotesk', system-ui, sans-serif;
      --font-display: 'Exo 2', 'Space Grotesk', sans-serif;
      --font-mono: 'Orbitron', monospace;
    }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-sans);
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* Nav */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 50;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(0, 245, 212, 0.15);
    }
    .nav-brand {
      font-family: var(--font-mono);
      font-weight: 600;
      font-size: 1rem;
      letter-spacing: 0.05em;
      color: var(--neon);
    }
    .nav-links {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    .nav-links a {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.8125rem;
      font-weight: 500;
      transition: color 0.2s, text-shadow 0.2s;
    }
    .nav-links a:hover { color: var(--neon); text-shadow: 0 0 20px rgba(0, 245, 212, 0.5); }
    .nav-cta {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 1rem;
      background: transparent;
      color: var(--neon);
      font-size: 0.875rem;
      font-weight: 600;
      text-decoration: none;
      border: 1px solid var(--neon);
      border-radius: 0.5rem;
      transition: box-shadow 0.2s, background 0.2s;
    }
    .nav-cta:hover { box-shadow: 0 0 24px rgba(0, 245, 212, 0.35); background: rgba(0, 245, 212, 0.08); }

    /* Signal Space Hero - 2030 explorable */
    .signal-hero {
      min-height: 100vh;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 6rem 1rem 4rem;
      overflow: hidden;
    }
    .signal-hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 50% at 50% 20%, rgba(123, 44, 191, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse 60% 40% at 80% 80%, rgba(0, 245, 212, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse 50% 30% at 20% 60%, rgba(247, 37, 133, 0.06) 0%, transparent 50%);
      pointer-events: none;
    }
    .signal-grid {
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(rgba(0, 245, 212, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 245, 212, 0.03) 1px, transparent 1px);
      background-size: 60px 60px;
      animation: gridPulse 8s ease-in-out infinite;
    }
    @keyframes gridPulse {
      0%, 100% { opacity: 0.6; } 50% { opacity: 1; }
    }
    .signal-title-wrap {
      position: relative;
      z-index: 2;
      text-align: center;
      margin-bottom: 2rem;
    }
    .signal-badge {
      font-family: var(--font-mono);
      font-size: 0.6875rem;
      font-weight: 600;
      letter-spacing: 0.2em;
      color: var(--neon);
      margin-bottom: 1rem;
      text-transform: uppercase;
    }
    .signal-title {
      font-family: var(--font-mono);
      font-weight: 800;
      font-size: clamp(1.75rem, 5vw, 3rem);
      letter-spacing: 0.02em;
      line-height: 1.15;
      color: #fff;
      text-shadow: 0 0 40px rgba(0, 245, 212, 0.2);
      max-width: 18ch;
      margin: 0 auto 0.75rem;
    }
    .signal-sub {
      font-size: 0.9375rem;
      color: var(--text-muted);
      max-width: 36ch;
      margin: 0 auto;
    }
    .signal-theme {
      margin-top: 1rem;
      font-size: 0.8125rem;
      color: rgba(255, 255, 255, 0.4);
    }
    .signal-theme span {
      color: var(--neon);
      cursor: pointer;
      transition: text-shadow 0.2s, color 0.2s;
    }
    .signal-theme span:hover {
      text-shadow: 0 0 16px rgba(0, 245, 212, 0.6);
    }
    body[data-storyline="product"] .signal-grid { background-image: linear-gradient(rgba(59, 130, 246, 0.06) 1px, transparent 1px), linear-gradient(90deg, rgba(59, 130, 246, 0.06) 1px, transparent 1px); }
    body[data-storyline="ads"] .signal-grid { background-image: linear-gradient(rgba(247, 37, 133, 0.06) 1px, transparent 1px), linear-gradient(90deg, rgba(247, 37, 133, 0.06) 1px, transparent 1px); }
    body[data-storyline="tech"] .signal-grid { background-image: linear-gradient(rgba(0, 245, 212, 0.06) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 245, 212, 0.06) 1px, transparent 1px); }
    body[data-storyline="ai"] .signal-grid { background-image: linear-gradient(rgba(123, 44, 191, 0.08) 1px, transparent 1px), linear-gradient(90deg, rgba(123, 44, 191, 0.08) 1px, transparent 1px); }
    .orbit-wrap {
      position: relative;
      width: min(90vw, 720px);
      height: min(70vh, 520px);
      margin: 2rem auto;
    }
    .orbit-center {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 245, 212, 0.25), rgba(123, 44, 191, 0.2));
      border: 1px solid rgba(0, 245, 212, 0.4);
      box-shadow: 0 0 60px rgba(0, 245, 212, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-mono);
      font-size: 0.65rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--neon);
    }
    .orbit-node {
      position: absolute;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-mono);
      font-size: 0.6rem;
      font-weight: 600;
      text-align: center;
      letter-spacing: 0.02em;
      color: rgba(255,255,255,0.9);
      text-decoration: none;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(15, 15, 25, 0.85);
      backdrop-filter: blur(8px);
      transition: transform 0.25s, box-shadow 0.25s, border-color 0.25s;
      z-index: 5;
    }
    .orbit-node:hover {
      transform: scale(1.12);
      box-shadow: 0 0 30px rgba(0, 245, 212, 0.35);
      border-color: var(--neon);
    }
    .orbit-node.exp {
      top: 8%; left: 50%; transform: translateX(-50%);
      background: linear-gradient(135deg, rgba(123, 44, 191, 0.4), rgba(0, 245, 212, 0.2));
    }
    .orbit-node.exp:hover { top: 8%; left: 50%; transform: translateX(-50%) scale(1.12); }
    .orbit-node.focus {
      top: 25%; right: 12%;
      background: linear-gradient(135deg, rgba(247, 37, 133, 0.3), rgba(123, 44, 191, 0.2));
    }
    .orbit-node.adsgupta {
      bottom: 25%; right: 12%;
      background: linear-gradient(135deg, rgba(0, 245, 212, 0.3), rgba(59, 130, 246, 0.2));
    }
    .orbit-node.subdomains {
      bottom: 8%; left: 50%; transform: translateX(-50%);
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(0, 245, 212, 0.2));
    }
    .orbit-node.subdomains:hover { bottom: 8%; left: 50%; transform: translateX(-50%) scale(1.12); }
    .orbit-node.linkedin {
      top: 25%; left: 12%;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(123, 44, 191, 0.2));
    }
    .orbit-node.audit {
      bottom: 25%; left: 12%;
      background: linear-gradient(135deg, rgba(247, 37, 133, 0.25), rgba(0, 245, 212, 0.15));
    }
    .signal-cta {
      position: relative;
      z-index: 2;
      margin-top: 1rem;
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .signal-cta strong { color: var(--neon); }

    /* Expandable story panel (replaces traditional sections) */
    .story-panel {
      position: fixed;
      inset: 0;
      z-index: 60;
      background: rgba(0, 0, 0, 0.92);
      backdrop-filter: blur(12px);
      padding: 5rem 1.5rem 2rem;
      overflow-y: auto;
      transform: translateY(100%);
      opacity: 0;
      visibility: hidden;
      transition: transform 0.4s ease, opacity 0.3s, visibility 0.3s;
    }
    .story-panel.is-open {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }
    .story-panel-close {
      position: absolute;
      top: 1.25rem;
      right: 1.25rem;
      width: 44px;
      height: 44px;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(255,255,255,0.05);
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
      border-radius: 10px;
      transition: border-color 0.2s, background 0.2s;
    }
    .story-panel-close:hover {
      border-color: var(--neon);
      background: rgba(0, 245, 212, 0.1);
    }
    .story-panel h2 {
      font-family: var(--font-mono);
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--neon);
    }
    .story-panel p, .story-panel li {
      color: var(--text-muted);
      font-size: 0.9375rem;
      margin-bottom: 0.75rem;
    }
    .story-panel a {
      color: var(--neon);
      text-decoration: none;
    }
    .story-panel a:hover { text-decoration: underline; }

    /* Footer */
    footer {
      border-top: 1px solid rgba(255,255,255,0.06);
      padding: 2rem 1.5rem;
      text-align: center;
      position: relative;
      z-index: 2;
    }
    footer p {
      font-size: 0.8125rem;
      color: var(--text-muted);
    }
    footer a {
      color: var(--neon);
      text-decoration: none;
    }
    footer a:hover { text-decoration: underline; }

    @media (max-width: 640px) {
      .nav-links { display: none; }
      .orbit-wrap { height: 380px; }
      .orbit-node { width: 48px; height: 48px; font-size: 0.55rem; }
    }

    /* Dev console */
    .dev-trigger {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 100;
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      border: 1px solid rgba(56, 189, 248, 0.35);
      color: #38bdf8;
      font-size: 1.25rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .dev-trigger:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 28px rgba(56, 189, 248, 0.25);
    }
    .dev-console {
      position: fixed;
      inset: 0;
      z-index: 200;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }
    .dev-console.is-open { display: flex; }
    .dev-console-panel {
      width: 100%;
      max-width: 1000px;
      max-height: 92vh;
      background: linear-gradient(180deg, #0c0f14 0%, #0a0d12 100%);
      border: 1px solid rgba(0, 245, 212, 0.25);
      border-radius: 16px;
      box-shadow: 0 24px 64px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .dev-console-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.25rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      background: rgba(15, 23, 42, 0.6);
    }
    .dev-console-title {
      font-family: var(--font-display);
      font-weight: 700;
      font-size: 1.125rem;
      letter-spacing: -0.02em;
      color: #f1f5f9;
    }
    .dev-console-subtitle {
      font-size: 0.6875rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #38bdf8;
      margin-top: 0.15rem;
    }
    .dev-console-close {
      width: 36px;
      height: 36px;
      border: none;
      background: rgba(255, 255, 255, 0.06);
      color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.25rem;
      line-height: 1;
      transition: background 0.2s, color 0.2s;
    }
    .dev-console-close:hover {
      background: rgba(248, 113, 113, 0.2);
      color: #f87171;
    }
    .dev-console-tabs {
      display: flex;
      gap: 0;
      padding: 0 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      background: rgba(15, 23, 42, 0.3);
    }
    .dev-console-tab {
      padding: 0.875rem 1.25rem;
      font-size: 0.8125rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.5);
      background: none;
      border: none;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      margin-bottom: -1px;
      transition: color 0.2s, border-color 0.2s;
    }
    .dev-console-tab:hover { color: rgba(255, 255, 255, 0.8); }
    .dev-console-tab.is-active {
      color: #38bdf8;
      border-bottom-color: #38bdf8;
    }
    .dev-console-body {
      flex: 1;
      overflow: auto;
      padding: 1.25rem;
    }
    .dev-tab-pane { display: none; }
    .dev-tab-pane.is-active { display: block; }
    .dev-url-row {
      display: flex;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .dev-url-input {
      flex: 1;
      padding: 0.75rem 1rem;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: #e2e8f0;
      font-size: 0.875rem;
      font-family: inherit;
    }
    .dev-url-input::placeholder { color: rgba(255, 255, 255, 0.35); }
    .dev-url-input:focus {
      outline: none;
      border-color: #38bdf8;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.2);
    }
    .dev-btn {
      padding: 0.75rem 1.25rem;
      background: #38bdf8;
      color: #0c0f14;
      border: none;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.2s;
    }
    .dev-btn:hover { opacity: 0.9; }
    .dev-btn.secondary {
      background: rgba(255, 255, 255, 0.1);
      color: #e2e8f0;
    }
    .dev-preview-frame-wrap {
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: #000;
      min-height: 420px;
    }
    .dev-preview-frame {
      width: 100%;
      height: 420px;
      border: none;
      display: block;
    }
    .dev-tag-form {
      display: grid;
      gap: 1rem;
      margin-bottom: 1.25rem;
    }
    .dev-tag-form label {
      display: block;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 0.35rem;
    }
    .dev-tag-form input, .dev-tag-form select {
      width: 100%;
      padding: 0.6rem 0.75rem;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      color: #e2e8f0;
      font-size: 0.875rem;
    }
    .dev-tag-form .row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .dev-tag-output-wrap {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: #0a0d12;
    }
    .dev-tag-output {
      width: 100%;
      min-height: 320px;
      padding: 1rem;
      font-family: ui-monospace, 'SF Mono', Monaco, monospace;
      font-size: 0.75rem;
      line-height: 1.5;
      color: #94a3b8;
      background: transparent;
      border: none;
      resize: vertical;
    }
    .dev-tag-output:focus { outline: none; }
    .dev-copy-wrap {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
    }
    .dev-copy-btn {
      padding: 0.5rem 0.875rem;
      background: rgba(56, 189, 248, 0.2);
      color: #38bdf8;
      border: 1px solid rgba(56, 189, 248, 0.4);
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .dev-copy-btn:hover {
      background: #38bdf8;
      color: #0c0f14;
    }
    .dev-copy-btn.copied {
      background: #22c55e;
      color: #0c0f14;
      border-color: #22c55e;
    }

    /* Demo view: single space for summary + prompt + ads (no new window) */
    .dev-demo-view {
      min-height: 380px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: #080a0e;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .dev-demo-view .demo-toolbar {
      display: flex;
      gap: 0.5rem;
      padding: 0.5rem 0.75rem;
      background: rgba(15, 23, 42, 0.6);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      flex-wrap: wrap;
    }
    .dev-demo-view .demo-toolbar a {
      padding: 0.35rem 0.6rem;
      font-size: 0.75rem;
      color: #38bdf8;
      text-decoration: none;
      border-radius: 4px;
      background: rgba(56, 189, 248, 0.1);
      transition: background 0.2s;
    }
    .dev-demo-view .demo-toolbar a:hover {
      background: rgba(56, 189, 248, 0.2);
    }
    .dev-demo-view .demo-content {
      flex: 1;
      padding: 1rem 1.25rem;
      overflow-y: auto;
      max-height: 340px;
    }
    .dev-demo-view .demo-content .summary-block {
      margin-bottom: 1rem;
      padding: 0.75rem;
      background: rgba(0, 245, 212, 0.06);
      border-left: 3px solid #00f5d4;
      border-radius: 0 8px 8px 0;
    }
    .dev-demo-view .demo-content .summary-block h4 {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #00f5d4;
      margin-bottom: 0.35rem;
    }
    .dev-demo-view .demo-content .prompt-block {
      margin-bottom: 1rem;
      padding: 0.75rem;
      background: rgba(123, 44, 191, 0.1);
      border-left: 3px solid #7b2cbf;
      border-radius: 0 8px 8px 0;
    }
    .dev-demo-view .demo-content .prompt-block h4 {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #a78bfa;
      margin-bottom: 0.35rem;
    }
    .dev-demo-view .demo-content .ads-block {
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.04);
      border: 1px dashed rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      min-height: 90px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255, 255, 255, 0.4);
      font-size: 0.75rem;
    }
    .dev-demo-view .demo-content .article-preview p {
      margin-bottom: 0.6rem;
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.85);
    }
    .dev-demo-view .demo-content .article-preview .demo-hyperlink {
      color: #38bdf8;
      cursor: pointer;
      text-decoration: underline;
      text-underline-offset: 2px;
    }
    .dev-demo-view .demo-content .article-preview .demo-hyperlink:hover {
      color: #00f5d4;
    }
    .dev-demo-view .recommended-section {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
    }
    .dev-demo-view .recommended-section h4 {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 0.5rem;
    }
    .dev-demo-view .recommended-section .rec-item {
      padding: 0.5rem 0;
      font-size: 0.8125rem;
      color: #38bdf8;
      cursor: pointer;
      text-decoration: none;
      display: block;
    }
    .dev-demo-view .recommended-section .rec-item:hover {
      color: #00f5d4;
    }

    /* Prototype tab: iframe + overlay controls */
    .dev-prototype-wrap {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .dev-prototype-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
    }
    .dev-prototype-controls input[type="url"] {
      flex: 1;
      min-width: 200px;
      padding: 0.6rem 0.75rem;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: #e2e8f0;
      font-size: 0.875rem;
    }
    .dev-prototype-overlays {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
    }
    .dev-prototype-overlays label {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
    }
    .dev-prototype-frame-wrap {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.08);
      min-height: 400px;
      background: #000;
    }
    .dev-prototype-frame {
      width: 100%;
      height: 420px;
      border: none;
      display: block;
    }
    .proto-overlay {
      position: absolute;
      pointer-events: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      color: rgba(255, 255, 255, 0.5);
      background: rgba(0, 0, 0, 0.5);
      border: 1px dashed rgba(0, 245, 212, 0.4);
    }
    .proto-overlay.header-sticky { top: 0; left: 0; right: 0; height: 50px; }
    .proto-overlay.infeed { left: 50%; transform: translateX(-50%); width: 300px; height: 250px; top: 30%; }
    .proto-overlay.footer-sticky { bottom: 0; left: 0; right: 0; height: 60px; }

    /* Unified widget (summarizer + prompts + ads + chat) */
    .unified-widget {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 360px;
      max-width: calc(100vw - 2rem);
      max-height: 85vh;
      background: linear-gradient(180deg, #0f172a 0%, #0c0f14 100%);
      border: 1px solid rgba(0, 245, 212, 0.25);
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
      z-index: 350;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }
    .unified-widget.is-open { display: flex; }
    .unified-widget-header {
      padding: 0.75rem 1rem;
      background: rgba(0, 245, 212, 0.08);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .unified-widget-header h3 {
      font-family: var(--font-mono);
      font-size: 0.8125rem;
      color: #00f5d4;
    }
    .unified-widget-close {
      width: 28px;
      height: 28px;
      border: none;
      background: rgba(255, 255, 255, 0.08);
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1.1rem;
      line-height: 1;
    }
    .unified-widget-body {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }
    .unified-widget .widget-summary,
    .unified-widget .widget-prompts,
    .unified-widget .widget-ads {
      margin-bottom: 1rem;
    }
    .unified-widget .widget-summary h4,
    .unified-widget .widget-prompts h4,
    .unified-widget .widget-ads h4 {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 0.4rem;
    }
    .unified-widget .widget-ads-placeholder {
      min-height: 80px;
      background: rgba(255, 255, 255, 0.04);
      border: 1px dashed rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: rgba(255, 255, 255, 0.4);
    }
    .unified-widget-chat {
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      padding: 0.75rem;
    }
    .unified-widget-chat input {
      width: 100%;
      padding: 0.6rem 0.75rem;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: #e2e8f0;
      font-size: 0.8125rem;
    }
    .unified-widget-chat input::placeholder { color: rgba(255, 255, 255, 0.35); }

    /* Draggable chatbot trigger */
    .chatbot-trigger {
      position: fixed;
      right: 1.5rem;
      bottom: 5rem;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(123, 44, 191, 0.9), rgba(0, 245, 212, 0.8));
      border: 2px solid rgba(255, 255, 255, 0.3);
      color: #fff;
      font-size: 1.5rem;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 300;
      box-shadow: 0 4px 24px rgba(123, 44, 191, 0.4);
      transition: transform 0.2s;
    }
    .chatbot-trigger:active { cursor: grabbing; }
    .chatbot-trigger:hover { transform: scale(1.08); }

    /* Mobile: sticky video player */
    .mobile-video-sticky {
      display: none;
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      width: 120px;
      height: 180px;
      border-radius: 12px;
      overflow: hidden;
      border: 2px solid rgba(0, 245, 212, 0.4);
      z-index: 280;
      background: #000;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    }
    @media (max-width: 768px) {
      .mobile-video-sticky { display: block; }
    }
    @media (min-width: 769px) {
      .mobile-video-sticky { display: none !important; }
    }
    .mobile-video-sticky .video-close {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 28px;
      height: 28px;
      border: none;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      border-radius: 50%;
      cursor: pointer;
      z-index: 2;
      font-size: 1rem;
      line-height: 1;
    }
    .mobile-video-sticky .video-placeholder {
      width: 100%;
      height: 100%;
      background: linear-gradient(180deg, #1a0a2e 0%, #0d0d1a 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255, 255, 255, 0.5);
      font-size: 0.65rem;
      text-align: center;
      padding: 0.5rem;
    }
  </style>
</head>
<body>
  <nav class="nav">
    <span class="nav-brand">RANJAN.DASGUPTA</span>
    <div class="nav-links">
      <a href="#" data-story="experience">Experience</a>
      <a href="#" data-story="focus">Focus</a>
      <a href="https://www.linkedin.com/in/ranjandsgpt/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    </div>
    <a href="https://adsgupta.com" class="nav-cta" target="_blank" rel="noopener noreferrer">AdsGupta â†’</a>
  </nav>

  <header class="signal-hero">
    <div class="signal-grid" aria-hidden="true"></div>
    <div class="signal-title-wrap">
      <p class="signal-badge" id="signalBadge">2030 Â· AdTech Â· AI Â· Programmatic</p>
      <h1 class="signal-title">Signal space</h1>
      <p class="signal-sub">Explore nodes to discover experience, focus, and projects. Each path leads somewhere.</p>
      <p class="signal-theme" id="signalTheme">
        <span data-theme="product">Product</span> Â· <span data-theme="ads">Ads</span> Â· <span data-theme="tech">Tech</span> Â· <span data-theme="ai">AI</span>
      </p>
    </div>
    <div class="orbit-wrap">
      <div class="orbit-center">YOU</div>
      <a href="#" class="orbit-node exp" data-story="experience" title="Experience">EXP</a>
      <a href="#" class="orbit-node focus" data-story="focus" title="Focus">FOCUS</a>
      <a href="https://adsgupta.com" class="orbit-node adsgupta" target="_blank" rel="noopener" title="AdsGupta">ADS</a>
      <a href="#" class="orbit-node subdomains" data-story="subdomains" title="Subdomains">SUBS</a>
      <a href="https://www.linkedin.com/in/ranjandsgpt/" class="orbit-node linkedin" target="_blank" rel="noopener" title="LinkedIn">IN</a>
      <a href="https://adsgupta.com/audit" class="orbit-node audit" target="_blank" rel="noopener" title="Audit">AUDIT</a>
    </div>
    <p class="signal-cta"><strong>Click any node</strong> to open its story Â· Dev console bottom-right</p>
  </header>

  <div id="story-experience" class="story-panel" aria-hidden="true">
    <button type="button" class="story-panel-close" data-close-panel aria-label="Close">Ã—</button>
    <h2>Experience</h2>
    <p><strong>2025 â€” Present</strong> Â· Product, Web & CTV Exchange Â· InMobi. New initiatives for exchange and convergence.</p>
    <p><strong>2020 â€” 2025</strong> Â· Product Growth, Programmatic Â· Glance. Scaled programmatic and monetization.</p>
    <p><strong>2019 â€” 2020</strong> Â· Product Strategy, Omni-Channel Â· Automatad. Monetization strategy and execution.</p>
    <p><strong>2015 â€” 2019</strong> Â· Technical Specialist Â· Google. DFP, AdX, DV360, SA360 for global publishers.</p>
  </div>
  <div id="story-focus" class="story-panel" aria-hidden="true">
    <button type="button" class="story-panel-close" data-close-panel aria-label="Close">Ã—</button>
    <h2>Focus</h2>
    <p><strong>Programmatic & Exchange</strong> Â· Web, App, and CTV monetization. SPO, yield, and unified stacks. InMobi Â· Glance.</p>
    <p><strong>AI & Advertising</strong> Â· Agentic AI, contextual intelligence, and future-focused ad products. AdsGupta.</p>
    <p><strong>Scale & Strategy</strong> Â· 200M+ revenue scale. Product strategy and ecosystem design. Bengaluru.</p>
  </div>
  <div id="story-subdomains" class="story-panel" aria-hidden="true">
    <button type="button" class="story-panel-close" data-close-panel aria-label="Close">Ã—</button>
    <h2>Subdomains & products</h2>
    <p><a href="https://talenos.adsgupta.com" target="_blank" rel="noopener">talenos.adsgupta.com</a> Â· <a href="https://demoai.adsgupta.com" target="_blank" rel="noopener">demoai.adsgupta.com</a> Â· <a href="https://adsgupta.com/audit" target="_blank" rel="noopener">adsgupta.com/audit</a></p>
  </div>

  <footer>
    <p>Ranjan Dasgupta Â· <a href="https://ranjan.adsgupta.com">ranjan.adsgupta.com</a> Â· <a href="https://adsgupta.com">adsgupta.com</a></p>
    <p style="margin-top: 0.5rem;">&copy; 2025</p>
  </footer>

  <button type="button" class="dev-trigger" id="devTrigger" title="Developer console" aria-label="Open developer console">âŒ˜</button>

  <div class="dev-console" id="devConsole" role="dialog" aria-label="Developer console">
    <div class="dev-console-panel">
      <header class="dev-console-header">
        <div>
          <div class="dev-console-title">AdTech Control Center</div>
          <div class="dev-console-subtitle">Unified monetization infrastructure</div>
        </div>
        <button type="button" class="dev-console-close" id="devConsoleClose" aria-label="Close">Ã—</button>
      </header>
      <div class="dev-console-tabs">
        <button type="button" class="dev-console-tab is-active" data-tab="monetization">[ AI MONETIZATION ]</button>
        <button type="button" class="dev-console-tab" data-tab="prototype">[ PROTOTYPE ]</button>
        <button type="button" class="dev-console-tab" data-tab="adtag">[ AD TAG ]</button>
      </div>
      <div class="dev-console-body">
        <div class="dev-tab-pane is-active" id="pane-monetization">
          <div class="dev-demo-view" id="devDemoView">
            <div class="demo-toolbar" id="demoToolbar">
              <a href="#" data-demo-reset>Show article</a>
              <a href="#" data-demo-topic="programmatic">Programmatic</a>
              <a href="#" data-demo-topic="header-bidding">Header Bidding</a>
              <a href="#" data-demo-topic="spo">SPO</a>
              <a href="#" data-demo-topic="ai-monetization">AI Monetization</a>
            </div>
            <div class="demo-content" id="demoContent">
              <div class="article-preview" id="articlePreview">
                <p>Ecosystem of <span class="demo-hyperlink" data-demo-topic="programmatic">Programmatic Ad Serving</span>: What's next? Insights on solving invisible problems: <span class="demo-hyperlink" data-demo-topic="header-bidding">auction inefficiencies</span>, identity gaps, and siloed stacks. By integrating <span class="demo-hyperlink" data-demo-topic="spo">SPO &amp; Pricing Callouts</span>, we turn siloed stacks into predictable, revenue-compounding machines. Scale handles over 200M+ Revenue across Web and App.</p>
              </div>
              <div class="summary-block" id="demoSummaryBlock" style="display:none;">
                <h4>Summary</h4>
                <p id="demoSummaryText"></p>
              </div>
              <div class="prompt-block" id="demoPromptBlock" style="display:none;">
                <h4>Prompt</h4>
                <p id="demoPromptText"></p>
              </div>
              <div class="ads-block" id="demoAdsBlock">Ad slot Â· 300Ã—250</div>
              <div class="recommended-section" id="demoRecommended">
                <h4>Recommended</h4>
                <a href="#" class="rec-item" data-demo-topic="programmatic">Summarize: Programmatic 101</a>
                <a href="#" class="rec-item" data-demo-topic="header-bidding">Summarize: Header Bidding Guide</a>
                <a href="#" class="rec-item" data-demo-topic="ai-monetization">Summarize: AI Monetization</a>
              </div>
            </div>
          </div>
        </div>
        <div class="dev-tab-pane" id="pane-prototype">
          <div class="dev-prototype-wrap">
            <div class="dev-prototype-controls">
              <input type="url" id="prototypeUrl" placeholder="https://example.com" value="">
              <button type="button" class="dev-btn" id="prototypeLoad">Load</button>
            </div>
            <div class="dev-prototype-overlays">
              <label><input type="checkbox" id="overlayHeaderSticky"> Header sticky</label>
              <label><input type="checkbox" id="overlayInfeed"> Infeed ad</label>
              <label><input type="checkbox" id="overlayFooterSticky"> Footer sticky</label>
              <label><input type="checkbox" id="overlayChatbot"> Chatbot</label>
            </div>
            <div class="dev-prototype-frame-wrap" id="prototypeFrameWrap">
              <div class="proto-overlay header-sticky" id="protoHeaderSticky" style="display:none;">Header sticky ad</div>
              <div class="proto-overlay infeed" id="protoInfeed" style="display:none;">Infeed 300Ã—250</div>
              <div class="proto-overlay footer-sticky" id="protoFooterSticky" style="display:none;">Footer sticky</div>
              <iframe class="dev-prototype-frame" id="prototypeFrame" title="Prototype preview"></iframe>
            </div>
          </div>
        </div>
        <div class="dev-tab-pane" id="pane-adtag">
          <div class="dev-tag-form">
            <div>
              <label for="adtagGptPath">GPT Ad unit path (e.g. /12345678/site/slot)</label>
              <input type="text" id="adtagGptPath" placeholder="/12345678/your-site/your-slot" value="/19968336/header-bid-tag-0">
            </div>
            <div class="row2">
              <div>
                <label for="adtagDivId">Div / slot element ID</label>
                <input type="text" id="adtagDivId" placeholder="div-gpt-ad-1234567890-0" value="div-gpt-ad-1460505748561-0">
              </div>
              <div>
                <label for="adtagSizes">Sizes (e.g. 300x250,300x600)</label>
                <input type="text" id="adtagSizes" placeholder="300x250,300x600" value="300x250,300x600">
              </div>
            </div>
            <div class="row2">
              <div>
                <label for="adtagPrebidPlacement">Prebid placement ID (e.g. OpenWrap)</label>
                <input type="text" id="adtagPrebidPlacement" placeholder="13144370" value="13144370">
              </div>
              <div>
                <label for="adtagAmazonPubId">Amazon TAM publisher ID (optional)</label>
                <input type="text" id="adtagAmazonPubId" placeholder="1234" value="">
              </div>
            </div>
          </div>
          <div class="dev-tag-output-wrap">
            <textarea class="dev-tag-output" id="adtagOutput" readonly></textarea>
            <div class="dev-copy-wrap">
              <button type="button" class="dev-copy-btn" id="adtagCopy">Copy tag</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="unified-widget" id="unifiedWidget">
    <div class="unified-widget-header">
      <h3>Summarizer Â· Prompts Â· Ads</h3>
      <button type="button" class="unified-widget-close" id="unifiedWidgetClose" aria-label="Close">Ã—</button>
    </div>
    <div class="unified-widget-body">
      <div class="widget-summary">
        <h4>Summary</h4>
        <p id="widgetSummaryText">Click a keyword or prompt to see a personalized summary here.</p>
      </div>
      <div class="widget-prompts">
        <h4>Prompts</h4>
        <p id="widgetPromptText">e.g. &quot;Summarize another article&quot; â€” click recommended prompts to load.</p>
      </div>
      <div class="widget-ads">
        <h4>Ads</h4>
        <div class="widget-ads-placeholder">Ad slot</div>
      </div>
    </div>
    <div class="unified-widget-chat">
      <input type="text" id="widgetChatInput" placeholder="Chat hereâ€¦">
    </div>
  </div>

  <button type="button" class="chatbot-trigger" id="chatbotTrigger" title="Open widget" aria-label="Chatbot">ðŸ’¬</button>

  <div class="mobile-video-sticky" id="mobileVideoSticky">
    <button type="button" class="video-close" id="mobileVideoClose" aria-label="Close video">Ã—</button>
    <div class="video-placeholder">Vertical video Â· Close to open widget</div>
  </div>

  <script>
    (function () {
      var PREBID_TIMEOUT = 1000;
      var FAILSAFE_TIMEOUT = 3300;

      var demoTopics = {
        'programmatic': { summary: 'Programmatic ad serving automates the buying and selling of ad inventory via real-time auctions, reducing friction and increasing yield.', prompt: 'Summarize: Programmatic 101 for publishers' },
        'header-bidding': { summary: 'Header bidding allows multiple demand partners to compete in a single auction before the ad server call, improving fill and CPM.', prompt: 'Summarize: Header Bidding best practices' },
        'spo': { summary: 'Supply-path optimization (SPO) and pricing callouts reduce auction inefficiencies and consolidate demand paths for predictable revenue.', prompt: 'Summarize: SPO & Pricing Callouts guide' },
        'ai-monetization': { summary: 'AI monetization uses agentic AI and contextual intelligence to personalize ad experiences and maximize revenue per user.', prompt: 'Summarize: AI-driven monetization strategies' }
      };

      function openStoryPanel(id) {
        document.querySelectorAll('.story-panel').forEach(function (p) {
          p.classList.remove('is-open');
          p.setAttribute('aria-hidden', 'true');
        });
        var panel = document.getElementById('story-' + id);
        if (panel) {
          panel.classList.add('is-open');
          panel.setAttribute('aria-hidden', 'false');
        }
      }
      function closeStoryPanels() {
        document.querySelectorAll('.story-panel').forEach(function (p) {
          p.classList.remove('is-open');
          p.setAttribute('aria-hidden', 'true');
        });
      }
      document.querySelectorAll('[data-story]').forEach(function (el) {
        el.addEventListener('click', function (e) {
          if (this.getAttribute('href') === '#') e.preventDefault();
          openStoryPanel(this.getAttribute('data-story'));
        });
      });
      document.querySelectorAll('[data-close-panel]').forEach(function (btn) {
        btn.addEventListener('click', closeStoryPanels);
      });

      var storylineLabels = { product: 'Product & scale', ads: 'Ads & monetization', tech: 'Tech & programmatic', ai: 'AI & advertising' };
      document.getElementById('signalTheme').addEventListener('click', function (e) {
        var t = e.target.closest('span[data-theme]');
        if (!t) return;
        var theme = t.getAttribute('data-theme');
        document.body.setAttribute('data-storyline', theme);
        document.getElementById('signalBadge').textContent = '2030 Â· ' + (storylineLabels[theme] || 'AdTech Â· AI Â· Programmatic');
      });

      function refreshDemoView(topic) {
        var data = demoTopics[topic] || demoTopics['programmatic'];
        var summaryBlock = document.getElementById('demoSummaryBlock');
        var promptBlock = document.getElementById('demoPromptBlock');
        var summaryText = document.getElementById('demoSummaryText');
        var promptText = document.getElementById('demoPromptText');
        var articlePreview = document.getElementById('articlePreview');
        summaryText.textContent = data.summary;
        promptText.textContent = data.prompt;
        summaryBlock.style.display = 'block';
        promptBlock.style.display = 'block';
        articlePreview.style.display = 'none';
      }
      function openUnifiedWidget(topic) {
        var data = demoTopics[topic] || demoTopics['programmatic'];
        document.getElementById('widgetSummaryText').textContent = data.summary;
        document.getElementById('widgetPromptText').textContent = data.prompt;
        document.getElementById('unifiedWidget').classList.add('is-open');
      }
      document.getElementById('demoContent').addEventListener('click', function (e) {
        var t = e.target.closest('[data-demo-topic]');
        if (!t) return;
        e.preventDefault();
        var topic = t.getAttribute('data-demo-topic');
        refreshDemoView(topic);
      });
      function resetDemoView() {
        document.getElementById('articlePreview').style.display = 'block';
        document.getElementById('demoSummaryBlock').style.display = 'none';
        document.getElementById('demoPromptBlock').style.display = 'none';
      }
      document.getElementById('demoToolbar').addEventListener('click', function (e) {
        var t = e.target.closest('a[data-demo-reset]');
        if (t) { e.preventDefault(); resetDemoView(); return; }
        t = e.target.closest('a[data-demo-topic]');
        if (!t) return;
        e.preventDefault();
        refreshDemoView(t.getAttribute('data-demo-topic'));
      });
      document.getElementById('demoRecommended').addEventListener('click', function (e) {
        var t = e.target.closest('a[data-demo-topic]');
        if (!t) return;
        e.preventDefault();
        var topic = t.getAttribute('data-demo-topic');
        refreshDemoView(topic);
        openUnifiedWidget(topic);
      });

      var chatbot = document.getElementById('chatbotTrigger');
      var widget = document.getElementById('unifiedWidget');
      document.getElementById('unifiedWidgetClose').addEventListener('click', function () {
        widget.classList.remove('is-open');
      });
      var dragHappened = false;
      chatbot.addEventListener('click', function (e) {
        if (dragHappened) { dragHappened = false; e.preventDefault(); return; }
        if (e.target === chatbot) widget.classList.add('is-open');
      });
      var drag = { dx: 0, dy: 0 };
      function moveChatbot(e) {
        dragHappened = true;
        chatbot.style.left = (e.clientX - drag.dx) + 'px';
        chatbot.style.top = (e.clientY - drag.dy) + 'px';
        chatbot.style.right = 'auto';
        chatbot.style.bottom = 'auto';
      }
      function startDrag(clientX, clientY) {
        var r = chatbot.getBoundingClientRect();
        drag.dx = clientX - r.left;
        drag.dy = clientY - r.top;
        document.addEventListener('mousemove', moveChatbot);
      }
      function moveChatbotTouch(e) {
        if (e.touches.length) { dragHappened = true; moveChatbot(e.touches[0]); }
      }
      chatbot.addEventListener('mousedown', function (e) {
        if (e.button !== 0) return;
        startDrag(e.clientX, e.clientY);
        e.preventDefault();
      });
      chatbot.addEventListener('touchstart', function (e) {
        if (e.touches.length) {
          startDrag(e.touches[0].clientX, e.touches[0].clientY);
          document.addEventListener('touchmove', moveChatbotTouch, { passive: true });
        }
      }, { passive: true });
      document.addEventListener('touchend', function () {
        document.removeEventListener('touchmove', moveChatbotTouch);
        document.removeEventListener('mousemove', moveChatbot);
      });
      document.addEventListener('mouseup', function () {
        document.removeEventListener('mousemove', moveChatbot);
      });

      document.getElementById('mobileVideoClose').addEventListener('click', function () {
        document.getElementById('mobileVideoSticky').style.display = 'none';
        openUnifiedWidget('ai-monetization');
      });

      document.getElementById('prototypeLoad').addEventListener('click', function () {
        var url = document.getElementById('prototypeUrl').value.trim();
        if (!url) return;
        if (!/^https?:/i.test(url)) url = 'https://' + url;
        document.getElementById('prototypeFrame').src = url;
      });
      function syncPrototypeOverlays() {
        document.getElementById('protoHeaderSticky').style.display = document.getElementById('overlayHeaderSticky').checked ? 'flex' : 'none';
        document.getElementById('protoInfeed').style.display = document.getElementById('overlayInfeed').checked ? 'flex' : 'none';
        document.getElementById('protoFooterSticky').style.display = document.getElementById('overlayFooterSticky').checked ? 'flex' : 'none';
      }
      ['overlayHeaderSticky', 'overlayInfeed', 'overlayFooterSticky', 'overlayChatbot'].forEach(function (id) {
        document.getElementById(id).addEventListener('change', function () {
          syncPrototypeOverlays();
          if (id === 'overlayChatbot') {
            chatbot.style.visibility = this.checked ? 'visible' : 'hidden';
          }
        });
      });

      function getAdTagScript() {
        var gptPath = document.getElementById('adtagGptPath').value.trim() || '/19968336/header-bid-tag-0';
        var divId = document.getElementById('adtagDivId').value.trim() || 'div-gpt-ad-1460505748561-0';
        var sizesStr = document.getElementById('adtagSizes').value.trim() || '300x250,300x600';
        var prebidPlacement = document.getElementById('adtagPrebidPlacement').value.trim() || '13144370';
        var amazonPubId = document.getElementById('adtagAmazonPubId').value.trim();

        var sizes = sizesStr.split(/[,\s]+/).map(function (s) {
          var parts = s.split(/x/i);
          return parts.length === 2 ? [parseInt(parts[0], 10), parseInt(parts[1], 10)] : null;
        }).filter(Boolean);
        var sizesJson = JSON.stringify(sizes);
        var sizesGpt = sizes.map(function (s) { return '[' + s.join(', ') + ']'; }).join(', ');

        var amazonBlock = '';
        if (amazonPubId) {
          amazonBlock = '\n  // Amazon TAM (Transparent Ad Marketplace) â€“ replace with your APS script from Amazon Publisher Services\n' +
            '  (function(d,z,s){s=d.createElement(\'script\');s.src=\'https://\'+z+\'/sdk/tam.js\';s.async=true;d.getElementsByTagName(\'head\')[0].appendChild(s);})(document,\'aps.amazon.com\');\n' +
            '  // Configure Amazon slot with your publisher ID: ' + amazonPubId + '\n';
        }

        var scriptEnd = '</scr' + 'ipt>';
        return '<!-- GPT + Prebid (OpenWrap) + Amazon TAM. Prebid OpenWrap: https://docs.prebid.org/prebid/openwrap/overview.html -->\n' +
          '<script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js">' + scriptEnd + '\n' +
          '<script async src="https://cdn.jsdelivr.net/npm/prebid.js@latest/dist/prebid.js">' + scriptEnd + '\n' +
          amazonBlock +
          '<script>\n' +
          '  var PREBID_TIMEOUT = ' + PREBID_TIMEOUT + ';\n' +
          '  var FAILSAFE_TIMEOUT = ' + FAILSAFE_TIMEOUT + ';\n' +
          '  var adUnits = [{\n' +
          '    code: \'' + divId + '\',\n' +
          '    mediaTypes: { banner: { sizes: ' + sizesJson + ' } },\n' +
          '    bids: [\n' +
          '      { bidder: \'appnexus\', params: { placementId: ' + prebidPlacement + ' } }\n' +
          '      // Add more bidders: openwraptag, rubicon, etc. See https://docs.prebid.org/dev-docs/bidders.html\n' +
          '    ]\n' +
          '  }];\n' +
          '  var pbjs = pbjs || {};\n' +
          '  pbjs.que = pbjs.que || [];\n' +
          '  var googletag = googletag || {};\n' +
          '  googletag.cmd = googletag.cmd || [];\n' +
          '  googletag.cmd.push(function () { googletag.pubads().disableInitialLoad(); });\n' +
          '  pbjs.que.push(function () {\n' +
          '    pbjs.addAdUnits(adUnits);\n' +
          '    pbjs.requestBids({ bidsBackHandler: sendAdserverRequest, timeout: PREBID_TIMEOUT });\n' +
          '  });\n' +
          '  function sendAdserverRequest() {\n' +
          '    if (pbjs.adserverRequestSent) return;\n' +
          '    pbjs.adserverRequestSent = true;\n' +
          '    googletag.cmd.push(function () {\n' +
          '      if (typeof pbjs.setTargetingForGPTAsync === \'function\') {\n' +
          '        pbjs.setTargetingForGPTAsync();\n' +
          '      }\n' +
          '      googletag.pubads().refresh();\n' +
          '    });\n' +
          '  }\n' +
          '  setTimeout(sendAdserverRequest, FAILSAFE_TIMEOUT);\n' +
          '  googletag.cmd.push(function () {\n' +
          '    googletag.defineSlot(\'' + gptPath.replace(/'/g, "\\'") + '\', [' + sizesGpt + '], \'' + divId + '\').addService(googletag.pubads());\n' +
          '    googletag.pubads().enableSingleRequest();\n' +
          '    googletag.enableServices();\n' +
          '  });\n' +
          scriptEnd + '\n' +
          '<!-- Ad slot div -->\n' +
          '<div id="' + divId + '"></div>\n' +
          '<script>\n' +
          '  googletag.cmd.push(function () { googletag.display(\'' + divId + '\'); });\n' +
          scriptEnd + '\n';
      }

      function updateAdTagOutput() {
        document.getElementById('adtagOutput').value = getAdTagScript();
      }

      var trigger = document.getElementById('devTrigger');
      var consoleEl = document.getElementById('devConsole');
      var closeBtn = document.getElementById('devConsoleClose');
      var tabs = document.querySelectorAll('.dev-console-tab');
      var copyBtn = document.getElementById('adtagCopy');
      var formInputs = document.querySelectorAll('#adtagGptPath, #adtagDivId, #adtagSizes, #adtagPrebidPlacement, #adtagAmazonPubId');

      trigger.addEventListener('click', function () {
        consoleEl.classList.add('is-open');
        updateAdTagOutput();
      });

      closeBtn.addEventListener('click', function () {
        consoleEl.classList.remove('is-open');
      });

      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' && consoleEl.classList.contains('is-open')) {
          consoleEl.classList.remove('is-open');
        }
      });

      consoleEl.addEventListener('click', function (e) {
        if (e.target === consoleEl) consoleEl.classList.remove('is-open');
      });

      tabs.forEach(function (tab) {
        tab.addEventListener('click', function () {
          var t = this.getAttribute('data-tab');
          tabs.forEach(function (x) { x.classList.remove('is-active'); });
          document.querySelectorAll('.dev-tab-pane').forEach(function (p) { p.classList.remove('is-active'); });
          this.classList.add('is-active');
          var pane = document.getElementById('pane-' + t);
          if (pane) pane.classList.add('is-active');
        });
      });

      formInputs.forEach(function (input) {
        input.addEventListener('input', updateAdTagOutput);
        input.addEventListener('change', updateAdTagOutput);
      });

      copyBtn.addEventListener('click', function () {
        var ta = document.getElementById('adtagOutput');
        ta.select();
        ta.setSelectionRange(0, 99999);
        try {
          document.execCommand('copy');
          copyBtn.textContent = 'Copied!';
          copyBtn.classList.add('copied');
          setTimeout(function () {
            copyBtn.textContent = 'Copy tag';
            copyBtn.classList.remove('copied');
          }, 2000);
        } catch (err) {
          copyBtn.textContent = 'Copy failed';
          setTimeout(function () { copyBtn.textContent = 'Copy tag'; }, 2000);
        }
      });

      updateAdTagOutput();
    })();
  </script>
</body>
</html>
